---
title: "Market Segmentation"
author: "Bret Jaco"
date: "8/15/2021"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r include=FALSE}
library(ggplot2)
library(LICORS)  # for kmeans++
library(foreach)
library(mosaic)

```

```{r echo=FALSE}
df = read.csv('social_marketing.csv')
```

# Market Segmentation

The data we are analyzing was collected in the course of a market-research study using followers of the Twitter account of a large consumer brand called NutrientH20. Over the course of a seven-day period, the follower's tweet were categorized using 36 different categories, each representing a broad area of interest.


## K-Means Clustering
To help NutrientH20 better understand its social-media audience, we used k-means clustering to group its twitter followers into different potential marketing segments. Prior to fitting the model, we removed the following variables, as they would not provide any beneficial insight to our problem: chatter, uncategorized, adult, and spam. 

```{r include=FALSE}
#removed user code, chatter, uncategorized, adult, and spam columns
X = df[,-c(1,2,6,36,37)]

# center and scale the data
X = scale(X, center=TRUE, scale=TRUE)

# Extract the centers and scales from the rescaled data
mu = attr(X,"scaled:center")
sigma = attr(X,"scaled:scale")
```

### Choosing the Number of Clusters

One of the difficulties in using K-Means Clustering is deciding how many clusters to use. We decided to use the Elbow method which looks at the total Within-Cluster Sum of Squares as a function of the number of clusters; One should choose a number of clusters so that adding another cluster doesnâ€™t significantly improve the total WSS.

```{r echo=FALSE}
# This takes a bit to run
# numClusters = c(2:3)
numClusters = c(2:15)
wss_all = NULL

set.seed(123)
for(c in numClusters){
  wss = sum(kmeanspp(X, k=c, nstart=25)$withinss)
  wss_all <- c(wss_all, wss)
}

#plotting the WSS by choosing various K's
plot(numClusters, wss_all, type = 'b',
     xlab = "Number of Clusters", ylab = "Within-Cluster Sum of Squares", 
     main = "WSS vs Number of Clusters")
```

Looking at the elbow plot above, we'll use 6 clusters for our analysis.


Another downside of K-means clustering is choosing the initial values, or "seeds", for the clusters. We use the K-means++
method to address this issue. The clustering will show us what tweet topics are typically posted together and help us form
consumer personas for the marketing department to target.

```{r echo=FALSE}
## Using kmeans++ initialization
set.seed(123)
clust = kmeanspp(X, k=6, nstart=25)
```

### Cluster 1

```{r echo=FALSE}
knitr::kable(head(sort((clust$center[1,]*sigma + mu), decreasing=TRUE)),caption = "Young Parents", digits = 2)
```
**Young Parents:** With interests such as sports fandom, religion, food, parenting, and school, this segment represents
young parents. They will want to provide their children with high quality water.


### Cluster 2

```{r echo=FALSE}
knitr::kable(head(sort((clust$center[2,]*sigma + mu), decreasing=TRUE)),caption = "Fitness Gurus", digits = 2)
```
**Fitness Gurus:** With health nutrition and personal fitness the predominant categories, this grouping represents
the healthy and fit archetype. They are likely to have a favorite water brand and stick to it.


### Cluster 3

```{r echo=FALSE}
knitr::kable(head(sort((clust$center[3,]*sigma + mu), decreasing=TRUE)),caption = "Millennial Influencers", digits = 2)
```
**Millennial Influencers:** This segment is interested in cooking, photo_sharing, fashion, and beauty and likely consists of social media influencers. They like to share things with their network and would be good marketers of NutrientH20.


### Cluster 4

```{r echo=FALSE}

knitr::kable(head(sort((clust$center[4,]*sigma + mu), decreasing=TRUE)),caption = "College Student", digits = 2)
```
**College Student:** This segment shows interest in college, online gaming, photo sharing, and sports. This sounds
like a typical college student who likely isn't too picky about what kind of water they drink.


### Cluster 5

```{r echo=FALSE}
knitr::kable(head(sort((clust$center[5,]*sigma + mu), decreasing=TRUE)),caption = "Traveling Businessman", digits = 2)
head(sort((clust$center[5,]*sigma + mu), decreasing=TRUE))
```
**Traveling Businessman:** This segment has interests in politics, travel, and news and represents the traveling businessman.
They would be a good group to target as they are frequently in airports and buying water bottles.


### Cluster 6

```{r echo=FALSE}
knitr::kable(head(sort((clust$center[6,]*sigma + mu), decreasing=TRUE)),caption = "Average Consumer", digits = 2)
```
**Average Consumer:** This cluster seems to be very balanced among various categories and doesn't provide too much
information into a specific archetype.


## Market Segments

1) **Young Parents**
2) **Fitness Gurus**
3) **Millennial Influencers**
4) **College Student**
5) **Traveling Businessman**
6) **Average Consumer**

NutrientH20 can target these market segments to improve their sales and popularity!











